<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="466px" preserveAspectRatio="none" style="width:1281px;height:466px;background:#FFFFFF;" version="1.1" viewBox="0 0 1281 466" width="1281px" zoomAndPan="magnify"><title>Windows Process Creation (Blog 1)</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="236.4756" x="521.3303" y="29.5332">Windows Process Creation (Blog 1)</text><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="262.8125" width="8" x="18.7793" y="121.2188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="22" x2="22" y1="121.2188" y2="384.0313"/></g><g><title>CreateProcess</title><rect fill="#000000" fill-opacity="0.00000" height="262.8125" width="8" x="99.855" y="121.2188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="103.5586" x2="103.5586" y1="121.2188" y2="384.0313"/></g><g><title>CreateProcessInternalW</title><rect fill="#000000" fill-opacity="0.00000" height="262.8125" width="8" x="246.4028" y="121.2188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="250.1514" x2="250.1514" y1="121.2188" y2="384.0313"/></g><g><title>NtCreateUserProcess</title><rect fill="#000000" fill-opacity="0.00000" height="262.8125" width="8" x="414.73" y="121.2188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="418.6543" x2="418.6543" y1="121.2188" y2="384.0313"/></g><g><title>Kernel</title><rect fill="#000000" fill-opacity="0.00000" height="262.8125" width="8" x="627.6489" y="121.2188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="631.4146" x2="631.4146" y1="121.2188" y2="384.0313"/></g><g><title>Loader</title><rect fill="#000000" fill-opacity="0.00000" height="262.8125" width="8" x="832.2715" y="121.2188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="835.4751" x2="835.4751" y1="121.2188" y2="384.0313"/></g><g><title>Thread</title><rect fill="#000000" fill-opacity="0.00000" height="262.8125" width="8" x="968.9741" y="121.2188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="972.7949" x2="972.7949" y1="121.2188" y2="384.0313"/></g><g><title>Runtime</title><rect fill="#000000" fill-opacity="0.00000" height="262.8125" width="8" x="1111.5039" y="121.2188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1115.4385" x2="1115.4385" y1="121.2188" y2="384.0313"/></g><g><title>Sysmon</title><rect fill="#000000" fill-opacity="0.00000" height="262.8125" width="8" x="1238.8501" y="121.2188"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1242.564" x2="1242.564" y1="121.2188" y2="384.0313"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.5586" x="5" y="118.1426">User</text><ellipse cx="22.7793" cy="52.1094" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M22.7793,60.1094 L22.7793,87.1094 M9.7793,68.1094 L35.7793,68.1094 M22.7793,87.1094 L9.7793,102.1094 M22.7793,87.1094 L35.7793,102.1094" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.5586" x="5" y="397.5645">User</text><ellipse cx="22.7793" cy="409.1406" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M22.7793,417.1406 L22.7793,444.1406 M9.7793,425.1406 L35.7793,425.1406 M22.7793,444.1406 L9.7793,459.1406 M22.7793,444.1406 L35.7793,459.1406" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="CreateProcess"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.5928" x="50.5586" y="88.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.5928" x="57.5586" y="110.1426">CreateProcess</text></g><g class="participant participant-tail" data-participant="CreateProcess"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.5928" x="50.5586" y="383.0313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.5928" x="57.5586" y="404.5645">CreateProcess</text></g><g class="participant participant-head" data-participant="CreateProcessInternalW"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="166.5029" x="167.1514" y="88.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152.5029" x="174.1514" y="110.1426">CreateProcessInternalW</text></g><g class="participant participant-tail" data-participant="CreateProcessInternalW"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="166.5029" x="167.1514" y="383.0313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152.5029" x="174.1514" y="404.5645">CreateProcessInternalW</text></g><g class="participant participant-head" data-participant="NtCreateUserProcess"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="150.1514" x="343.6543" y="88.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136.1514" x="350.6543" y="110.1426">NtCreateUserProcess</text></g><g class="participant participant-tail" data-participant="NtCreateUserProcess"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="150.1514" x="343.6543" y="383.0313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136.1514" x="350.6543" y="404.5645">NtCreateUserProcess</text></g><g class="participant participant-head" data-participant="Kernel"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.4688" x="604.4146" y="88.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.4688" x="611.4146" y="110.1426">Kernel</text></g><g class="participant participant-tail" data-participant="Kernel"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.4688" x="604.4146" y="383.0313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.4688" x="611.4146" y="404.5645">Kernel</text></g><g class="participant participant-head" data-participant="Loader"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57.5928" x="807.4751" y="88.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43.5928" x="814.4751" y="110.1426">Loader</text></g><g class="participant participant-tail" data-participant="Loader"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57.5928" x="807.4751" y="383.0313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43.5928" x="814.4751" y="404.5645">Loader</text></g><g class="participant participant-head" data-participant="Thread"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="58.3584" x="943.7949" y="88.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.3584" x="950.7949" y="110.1426">Thread</text></g><g class="participant participant-tail" data-participant="Thread"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="58.3584" x="943.7949" y="383.0313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.3584" x="950.7949" y="404.5645">Thread</text></g><g class="participant participant-head" data-participant="Runtime"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="66.1309" x="1082.4385" y="88.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52.1309" x="1089.4385" y="110.1426">Runtime</text></g><g class="participant participant-tail" data-participant="Runtime"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="66.1309" x="1082.4385" y="383.0313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52.1309" x="1089.4385" y="404.5645">Runtime</text></g><g class="participant participant-head" data-participant="Sysmon"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64.5723" x="1210.564" y="88.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.5723" x="1217.564" y="110.1426">Sysmon</text></g><g class="participant participant-tail" data-participant="Sysmon"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64.5723" x="1210.564" y="383.0313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.5723" x="1217.564" y="404.5645">Sysmon</text></g><g class="message" data-participant-1="User" data-participant-2="CreateProcess"><polygon fill="#181818" points="91.855,149.5703,101.855,153.5703,91.855,157.5703,95.855,153.5703" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="22.7793" x2="97.855" y1="153.5703" y2="153.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44.0718" x="29.7793" y="148.7139">API call</text></g><g class="message" data-participant-1="CreateProcess" data-participant-2="CreateProcessInternalW"><polygon fill="#181818" points="238.4028,179.9219,248.4028,183.9219,238.4028,187.9219,242.4028,183.9219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="103.855" x2="244.4028" y1="183.9219" y2="183.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42.6372" x="110.855" y="179.0654">internal</text></g><g class="message" data-participant-1="CreateProcessInternalW" data-participant-2="NtCreateUserProcess"><polygon fill="#181818" points="406.73,210.2734,416.73,214.2734,406.73,218.2734,410.73,214.2734" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="250.4028" x2="412.73" y1="214.2734" y2="214.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39.0063" x="257.4028" y="209.417">syscall</text></g><g class="message" data-participant-1="NtCreateUserProcess" data-participant-2="Kernel"><polygon fill="#181818" points="619.6489,240.625,629.6489,244.625,619.6489,248.625,623.6489,244.625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="418.73" x2="625.6489" y1="244.625" y2="244.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.9189" x="425.73" y="239.7686">create EPROCESS + ETHREAD</text></g><g class="message" data-participant-1="Kernel" data-participant-2="Loader"><polygon fill="#181818" points="824.2715,270.9766,834.2715,274.9766,824.2715,278.9766,828.2715,274.9766" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="631.6489" x2="830.2715" y1="274.9766" y2="274.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.6226" x="638.6489" y="270.1201">map PE image, resolve imports</text></g><g class="message" data-participant-1="Loader" data-participant-2="Thread"><polygon fill="#181818" points="960.9741,301.3281,970.9741,305.3281,960.9741,309.3281,964.9741,305.3281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="836.2715" x2="966.9741" y1="305.3281" y2="305.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.7026" x="843.2715" y="300.4717">start primary thread</text></g><g class="message" data-participant-1="Thread" data-participant-2="Runtime"><polygon fill="#181818" points="1103.5039,331.6797,1113.5039,335.6797,1103.5039,339.6797,1107.5039,335.6797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="972.9741" x2="1109.5039" y1="335.6797" y2="335.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.5298" x="979.9741" y="330.8232">handoff to entrypoint</text></g><g class="message" data-participant-1="Runtime" data-participant-2="Sysmon"><polygon fill="#181818" points="1230.8501,362.0313,1240.8501,366.0313,1230.8501,370.0313,1234.8501,366.0313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1115.5039" x2="1236.8501" y1="366.0313" y2="366.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.3462" x="1122.5039" y="361.1748">Event ID 1 logged</text></g><!--SRC=[TP31JiCm38RlUOh_208Ek_Q0DBPAgq1GjKCxHwtNHKgJoZ53VNlShXC2mILAydzV75kSUCB1XJP-9fGS6qe96oOhBWRSFFdOONLhZ6qaCjuJiPaMF3nUABew6TPbWSPwRtu6lyaY276m_g2AM_Rc7qBTLxbaKzNlMcbCSwc_KfMUrIUlN3EdoClgRPFNDUwGxtTLljwQ1L7u9TfMEyhGsm5b3jVRZkx1bA8_anw7o9BCWgcmF-chxVGBiImOM0qU8VErMLBbgeyWhYS5JrO7V3n28YW8ZqFKpiqrLxGUKw_ppf2V5K2nnGew-evQymK0]--></g></svg>